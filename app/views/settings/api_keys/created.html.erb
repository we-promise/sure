<%= content_for :page_title, t(".title") %>

<%= settings_section title: t(".success_title"), subtitle: t(".success_description") do %>
  <div class="space-y-4">
    <div class="p-3 shadow-border-xs bg-container rounded-lg">
      <div class="flex items-start gap-3">
        <%= render DS::FilledIcon.new(
          icon: "check-circle",
          rounded: true,
          size: "lg",
          variant: :success
        ) %>
        <div class="flex-1">
          <h3 class="font-medium text-primary"><%= t(".success_title") %></h3>
          <p class="text-secondary text-sm mt-1"><%= t(".success_description_with_name", name: @api_key.name) %></p>
        </div>
      </div>
    </div>

    <div class="bg-surface-inset rounded-xl p-4">
      <h4 class="font-medium text-primary mb-3"><%= t(".your_api_key") %></h4>
      <p class="text-secondary text-sm mb-3"><%= t(".success_description") %></p>

      <div class="bg-container rounded-lg p-3 border border-primary" data-controller="clipboard">
        <div class="flex items-center justify-between gap-3">
          <code id="api-key-display" class="font-mono text-sm text-primary break-all" data-clipboard-target="source"><%= @api_key.plain_key %></code>
          <%= render DS::Button.new(
            text: t(".copy_key"),
            variant: "ghost",
            icon: "copy",
            data: { action: "clipboard#copy" }
          ) %>
        </div>
      </div>
    </div>

    <div class="bg-surface-inset rounded-xl p-4">
      <h4 class="font-medium text-primary mb-3"><%= t(".key_details") %></h4>
      <div class="space-y-2 text-sm">
        <div class="flex justify-between">
          <span class="text-secondary"><%= t(".key_name") %>:</span>
          <span class="text-primary font-medium"><%= @api_key.name %></span>
        </div>
        <div class="flex justify-between">
          <span class="text-secondary"><%= t(".permissions") %>:</span>
          <span class="text-primary">
            <%= @api_key.scopes.map { |scope|
              t("settings.api_keys_controller.scope_descriptions.#{scope}", default: scope.humanize)
            }.join(", ") %>
          </span>
        </div>
        <div class="flex justify-between">
          <span class="text-secondary"><%= t(".created") %>:</span>
          <span class="text-primary"><%= l(@api_key.created_at, format: :long) %></span>
        </div>
      </div>
    </div>

    <div class="bg-warning-50 border border-warning-200 rounded-xl p-4">
      <div class="flex items-start gap-2">
        <%= icon("alert-triangle", class: "w-5 h-5 text-warning-600 mt-0.5") %>
        <div>
          <h4 class="font-medium text-warning-800 text-sm"><%= t(".critical_warning_title") %></h4>
          <p class="text-warning-700 text-sm mt-1">
            <%= t(".critical_warning_1") %> <%= t(".critical_warning_2") %>
            <%= t(".critical_warning_3") %>
          </p>
        </div>
      </div>
    </div>

    <div class="bg-surface-inset rounded-xl p-4">
      <h4 class="font-medium text-primary mb-3"><%= t(".usage_instructions_title") %></h4>
      <p class="text-secondary text-sm mb-3"><%= t(".usage_instructions") %></p>
      <div class="bg-container rounded-lg p-3 font-mono text-sm text-primary border border-primary">
        curl -H "X-Api-Key: <%= @api_key.plain_key %>" <%= request.base_url %>/api/v1/accounts
      </div>
    </div>

    <div class="flex justify-end pt-4 border-t border-primary">
      <%= render DS::Link.new(
        text: t(".continue"),
        href: settings_api_key_path,
        variant: "primary"
      ) %>
    </div>
  </div>
<% end %>
