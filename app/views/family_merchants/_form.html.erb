<%# locals: (family_merchant:) %>

<div data-controller="color-avatar">
  <%= styled_form_with model: family_merchant, url: family_merchant.persisted? ? family_merchant_path(family_merchant) : family_merchants_path, class: "space-y-4" do |f| %>
    <% if family_merchant.errors.any? %>
      <%= render "shared/form_errors", model: family_merchant %>
    <% end %>

    <div class="flex flex-col items-center gap-4 mb-4">
      <%= render partial: "shared/color_avatar", locals: { name: family_merchant.name, color: family_merchant.color } %>

      <div class="flex gap-2 items-center justify-center">
        <% FamilyMerchant::COLORS.each do |color| %>
          <label class="relative">
            <%= f.radio_button :color, color, class: "sr-only peer", data: { action: "change->color-avatar#handleColorChange" } %>
            <div class="w-6 h-6 rounded-full cursor-pointer peer-checked:ring-2 peer-checked:ring-offset-2 peer-checked:ring-blue-500" style="background-color: <%= color %>"></div>
          </label>
        <% end %>
      </div>
    </div>

    <%= f.text_field :name,
          label: t(".name_label"),
          placeholder: t(".name_placeholder"),
          autofocus: true,
          required: true,
          data: { color_avatar_target: "name" } %>

    <% if family_merchant.is_a?(FamilyMerchant) %>
      <%= f.text_field :website_url,
            label: t(".website_label"),
            placeholder: t(".website_placeholder"),
            help_text: t(".website_hint") %>
    <% end %>

    <%= f.submit t("common.save") %>
  <% end %>
</div>