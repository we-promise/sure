<%# locals: none; uses @stats, @error_buckets, @errors %>
<%= turbo_frame_tag "modal" do %>
  <div class="p-4 space-y-4">
    <div class="flex items-center justify-between">
      <h3 class="text-primary font-medium">SimpleFin Sync Errors</h3>
      <%= link_to "Close", "#", data: { action: "modal#close" }, class: "text-secondary text-sm" %>
    </div>

    <% if @error_buckets.present? %>
      <div class="text-sm text-secondary">
        <span class="font-medium text-primary">Categories:</span>
        <%= @error_buckets.map { |k,v| "#{k}: #{v}" }.join(", ") %>
      </div>
    <% end %>

    <% if @errors.any? %>
      <div class="divide-y divide-gray-200 rounded-md border border-gray-200">
        <% @errors.each do |e| %>
          <div class="p-3">
            <div class="flex items-center justify-between">
              <div class="font-medium text-primary"><%= e[:name].presence || e[:account_id] || "Unknown account" %></div>
              <% if e[:category].present? %>
                <span class="text-xs text-secondary uppercase"><%= e[:category] %></span>
              <% end %>
            </div>
            <div class="text-sm text-secondary mt-1"><%= e[:message] %></div>
          </div>
        <% end %>
      </div>
    <% else %>
      <p class="text-secondary text-sm">No recent per-account errors.</p>
    <% end %>
  </div>
<% end %>
