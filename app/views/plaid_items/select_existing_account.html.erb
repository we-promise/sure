<%= turbo_frame_tag "modal" do %>
  <%= render DS::Dialog.new do |dialog| %>
    <% dialog.with_header(title: t(".title", account_name: @account.name)) %>

    <% dialog.with_body do %>
      <div class="space-y-4">
        <p class="text-sm text-secondary">
          <%= t(".description") %>
        </p>

        <%= form_with url: link_existing_account_plaid_items_path, method: :post, class: "space-y-4", data: { turbo_frame: "_top" } do |form| %>
          <%= hidden_field_tag :account_id, @account.id %>

          <div class="space-y-2">
            <% @available_plaid_accounts.each do |plaid_account| %>
              <label class="flex items-start gap-3 p-3 border border-primary rounded-lg hover:bg-surface-hover cursor-pointer transition-colors group">
                <%= radio_button_tag "plaid_account_id", plaid_account.id, false, class: "form-field__radio mt-1" %>
                <div class="flex-1">
                  <div class="font-medium text-sm text-primary group-hover:text-primary-hover">
                    <%= plaid_account.name %>
                  </div>
                  <div class="text-xs text-secondary mt-1">
                    <% if plaid_account.mask.present? %>
                      ****<%= plaid_account.mask %> •
                    <% end %>
                    <%= plaid_account.plaid_item.name %> • <%= plaid_account.currency %> • <%= plaid_account.plaid_type %>
                  </div>
                </div>
              </label>
            <% end %>
          </div>

          <div class="flex gap-2 justify-end pt-4">
            <%= render DS::Link.new(
                  text: t(".cancel"),
                  href: accounts_path,
                  variant: :secondary,
                  data: { turbo_frame: "_top", action: "DS--dialog#close" }
                ) %>
            <%= render DS::Button.new(
                  text: t(".link_account"),
                  variant: :primary,
                  type: :submit
                ) %>
          </div>
        <% end %>
      </div>
    <% end %>
  <% end %>
<% end %>